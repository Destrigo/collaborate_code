{"ast":null,"code":"// frontend/src/hooks/useAuth.js\nimport{useState,useEffect}from'react';import{getCurrentUser,login as apiLogin,register as apiRegister}from'../services/api';/**\n * @description Central hook for managing user authentication state.\n */export const useAuth=()=>{const[user,setUser]=useState(null);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);// Load user from API on mount using stored token\nuseEffect(()=>{const loadUser=async()=>{if(localStorage.getItem('token')){try{const userData=await getCurrentUser();setUser(userData);}catch(err){// Token is invalid or expired, clear it\nlocalStorage.removeItem('token');setUser(null);console.error(\"Token invalid:\",err);}}setIsLoading(false);};loadUser();},[]);const login=async(username,password)=>{setIsLoading(true);setError(null);try{const{user:userData}=await apiLogin(username,password);setUser(userData);return userData;}catch(err){setError(err.message||'Login failed.');throw err;}finally{setIsLoading(false);}};const register=async(username,password)=>{setIsLoading(true);setError(null);try{const{user:userData}=await apiRegister(username,password);setUser(userData);return userData;}catch(err){setError(err.message||'Registration failed.');throw err;}finally{setIsLoading(false);}};const logout=()=>{localStorage.removeItem('token');setUser(null);};return{user,setUser,isLoading,error,login,register,logout,isAuthenticated:!!user,globalRating:(user===null||user===void 0?void 0:user.rating)||0};};","map":{"version":3,"names":["useState","useEffect","getCurrentUser","login","apiLogin","register","apiRegister","useAuth","user","setUser","isLoading","setIsLoading","error","setError","loadUser","localStorage","getItem","userData","err","removeItem","console","username","password","message","logout","isAuthenticated","globalRating","rating"],"sources":["/home/marco/workstation/stormbrainer/frontend_lvb_stormbrainer/stormbrainer/frontend/src/hooks/useAuth.js"],"sourcesContent":["// frontend/src/hooks/useAuth.js\n\nimport { useState, useEffect } from 'react';\nimport { getCurrentUser, login as apiLogin, register as apiRegister } from '../services/api';\n\n/**\n * @description Central hook for managing user authentication state.\n */\nexport const useAuth = () => {\n    const [user, setUser] = useState(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // Load user from API on mount using stored token\n    useEffect(() => {\n        const loadUser = async () => {\n            if (localStorage.getItem('token')) {\n                try {\n                    const userData = await getCurrentUser();\n                    setUser(userData);\n                } catch (err) {\n                    // Token is invalid or expired, clear it\n                    localStorage.removeItem('token');\n                    setUser(null);\n                    console.error(\"Token invalid:\", err);\n                }\n            }\n            setIsLoading(false);\n        };\n        loadUser();\n    }, []);\n\n    const login = async (username, password) => {\n        setIsLoading(true);\n        setError(null);\n        try {\n            const { user: userData } = await apiLogin(username, password);\n            setUser(userData);\n            return userData;\n        } catch (err) {\n            setError(err.message || 'Login failed.');\n            throw err;\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const register = async (username, password) => {\n        setIsLoading(true);\n        setError(null);\n        try {\n            const { user: userData } = await apiRegister(username, password);\n            setUser(userData);\n            return userData;\n        } catch (err) {\n            setError(err.message || 'Registration failed.');\n            throw err;\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('token');\n        setUser(null);\n    };\n\n    return {\n        user,\n        setUser,\n        isLoading,\n        error,\n        login,\n        register,\n        logout,\n        isAuthenticated: !!user,\n        globalRating: user?.rating || 0\n    };\n};\n"],"mappings":"AAAA;AAEA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,cAAc,CAAEC,KAAK,GAAI,CAAAC,QAAQ,CAAEC,QAAQ,GAAI,CAAAC,WAAW,KAAQ,iBAAiB,CAE5F;AACA;AACA,GACA,MAAO,MAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACzB,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACU,SAAS,CAAEC,YAAY,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACY,KAAK,CAAEC,QAAQ,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAExC;AACAC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAa,QAAQ,CAAG,KAAAA,CAAA,GAAY,CACzB,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CAC/B,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAf,cAAc,CAAC,CAAC,CACvCO,OAAO,CAACQ,QAAQ,CAAC,CACrB,CAAE,MAAOC,GAAG,CAAE,CACV;AACAH,YAAY,CAACI,UAAU,CAAC,OAAO,CAAC,CAChCV,OAAO,CAAC,IAAI,CAAC,CACbW,OAAO,CAACR,KAAK,CAAC,gBAAgB,CAAEM,GAAG,CAAC,CACxC,CACJ,CACAP,YAAY,CAAC,KAAK,CAAC,CACvB,CAAC,CACDG,QAAQ,CAAC,CAAC,CACd,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAX,KAAK,CAAG,KAAAA,CAAOkB,QAAQ,CAAEC,QAAQ,GAAK,CACxCX,YAAY,CAAC,IAAI,CAAC,CAClBE,QAAQ,CAAC,IAAI,CAAC,CACd,GAAI,CACA,KAAM,CAAEL,IAAI,CAAES,QAAS,CAAC,CAAG,KAAM,CAAAb,QAAQ,CAACiB,QAAQ,CAAEC,QAAQ,CAAC,CAC7Db,OAAO,CAACQ,QAAQ,CAAC,CACjB,MAAO,CAAAA,QAAQ,CACnB,CAAE,MAAOC,GAAG,CAAE,CACVL,QAAQ,CAACK,GAAG,CAACK,OAAO,EAAI,eAAe,CAAC,CACxC,KAAM,CAAAL,GAAG,CACb,CAAC,OAAS,CACNP,YAAY,CAAC,KAAK,CAAC,CACvB,CACJ,CAAC,CAED,KAAM,CAAAN,QAAQ,CAAG,KAAAA,CAAOgB,QAAQ,CAAEC,QAAQ,GAAK,CAC3CX,YAAY,CAAC,IAAI,CAAC,CAClBE,QAAQ,CAAC,IAAI,CAAC,CACd,GAAI,CACA,KAAM,CAAEL,IAAI,CAAES,QAAS,CAAC,CAAG,KAAM,CAAAX,WAAW,CAACe,QAAQ,CAAEC,QAAQ,CAAC,CAChEb,OAAO,CAACQ,QAAQ,CAAC,CACjB,MAAO,CAAAA,QAAQ,CACnB,CAAE,MAAOC,GAAG,CAAE,CACVL,QAAQ,CAACK,GAAG,CAACK,OAAO,EAAI,sBAAsB,CAAC,CAC/C,KAAM,CAAAL,GAAG,CACb,CAAC,OAAS,CACNP,YAAY,CAAC,KAAK,CAAC,CACvB,CACJ,CAAC,CAED,KAAM,CAAAa,MAAM,CAAGA,CAAA,GAAM,CACjBT,YAAY,CAACI,UAAU,CAAC,OAAO,CAAC,CAChCV,OAAO,CAAC,IAAI,CAAC,CACjB,CAAC,CAED,MAAO,CACHD,IAAI,CACJC,OAAO,CACPC,SAAS,CACTE,KAAK,CACLT,KAAK,CACLE,QAAQ,CACRmB,MAAM,CACNC,eAAe,CAAE,CAAC,CAACjB,IAAI,CACvBkB,YAAY,CAAE,CAAAlB,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmB,MAAM,GAAI,CAClC,CAAC,CACL,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}